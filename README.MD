ä¼ é€é—¨æ•™ç¨‹ï¼šhttps://miyogurt.github.io/nodelover-books/#/koa-todo-api/æ­å»ºé¡¹ç›®å¼€å‘ç¯å¢ƒ

æºç åœ°å€ï¼šhttps://github.com/MiYogurt/todo-api

---

**0ï¸âƒ£ æ–°å»ºé¡¹ç›®**ï¼š`$ mkdir todo && cd todo && npm init -y && git init`

**1ï¸âƒ£ å®‰è£… Typescript ç¯å¢ƒ**ï¼š`$ npm i -g typescript && tsc --init`

**2ï¸âƒ£ å®‰è£…ä¾èµ–é¡¹**ï¼š`$ npm i koa -S && npm i @types/koa @types/node -D`

**3ï¸âƒ£ é…ç½®tsconfig.json**ï¼šé…ç½®è¾“å‡ºæ–‡ä»¶å¤¹ï¼Œä¸”ä½¿å…¶æ”¯æŒ async/await ç‰¹æ€§ã€‚

```JavaScript
{
    "compilerOptions": {
        "module": "commonjs",
        "target": "es5",
        "noImplicitAny": false,
        "sourceMap": false,
        "outDir": "dist",
        "lib": [
            "es6",
            "es7"
        ]
    }
}
```

**4ï¸âƒ£ åˆ›å»º src/index.ts ï¼š**

```Typescript
import * as Koa from 'koa';

const app = new Koa();

app.use(async ctx => {
    ctx.body = "Todo App";
});

app.listen(3000, () => {
    console.log("Server Stared on http://localhost:3000")
})
```

ç”±äºä½¿ç”¨äº† **Typescript** ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ **Node.js** ä¸­ä½¿ç”¨ `es6 modules` è§„èŒƒäº†ã€‚

æˆ‘ä»¬å…ˆåœ¨å‘½ä»¤è¡Œé‡Œé¢è¾“å…¥ï¼š `$ tsc` 

ç„¶åä¼šå¯¹æ‰€æœ‰.tsæ–‡ä»¶è¿›è¡Œç¼–è¯‘ã€‚å½“ç¼–è¯‘å®Œæˆä¹‹åï¼Œæˆ‘ä»¬åº”è¯¥å¯ä»¥çœ‹åˆ°ä¸€ä¸ª dist æ–‡ä»¶å¤¹ã€‚


**5ï¸âƒ£ package.json å¢åŠ  start è„šæœ¬**

```bash
"start": "node dist/index.js"
```

å†åœ¨å‘½ä»¤è¡Œé‡Œé¢è¿è¡Œï¼š`npm start`

**6ï¸âƒ£ éƒ¨ç½² node æœåŠ¡å™¨çš„ç¥å™¨ï¼š pm2**

éš¾é“æ¯æ¬¡å†™å®Œä»£ç æˆ‘éƒ½éœ€è¦é‡å¯æœåŠ¡å™¨ï¼Ÿ
ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ pm2 è¿™ä¸ªå·¥å…·ï¼Œè¿™æ˜¯ä¸€ä¸ªéƒ¨ç½² node æœåŠ¡å™¨çš„å·¥å…·ï¼Œèƒ½å¤Ÿå®ç°è‡ªåŠ¨é‡å¯ã€‚

é¦–å…ˆå…¨å±€å®‰è£… pm2ï¼š `$ npm i -g pm2`

åœ¨ package.json é‡Œé¢æ·»åŠ ä¸€äº›è„šæœ¬ï¼š

```JavaScript
"scripts": {
    "tsc": "tsc --watch",
    "start": "pm2 start dist/index.js --watch dist"
},
```

> æ­¤æ—¶æˆ‘ä»¬éœ€è¦å¯åŠ¨ä¿©ä¸ªæ§åˆ¶å°ï¼šå…ˆè¿è¡Œ tsc å‘½ä»¤ï¼Œå†è¿è¡Œ start.

```JavaScript
$ npm run tsc

/* æ–°å»ºå¦ä¸€ä¸ªçª—å£ */

$ npm run start
```

**7 å®‰è£… body è§£ææ’ä»¶ï¼š** `$ npm install koa-better-body -S`

ğŸš€ æ‰€æœ‰ koa æ’ä»¶éƒ½å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ï¼šhttps://github.com/koajs/koa/wiki

